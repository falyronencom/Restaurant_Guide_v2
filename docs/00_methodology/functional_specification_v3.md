# Restaurant Guide Belarus
## Функциональная спецификация проекта

*Версия 3.0*
*Последнее обновление: Ноябрь 2025*

> **Примечание:** Методология разработки проекта описана отдельно в [Methodology v8.0](methodology_v8.0.md)

---

## Часть I: Обзор проекта и бизнес-контекст

### 1.1 Проблема и решение

**Проблема:** В Беларуси отсутствует единая, современная платформа для поиска и выбора заведений общепита, адаптированная под местную специфику. Существующие решения либо устарели, либо не покрывают все потребности пользователей и бизнеса.

**Решение:** Мобильное приложение по модели Booking.com, адаптированное для ресторанного бизнеса Беларуси, с фокусом на:
- Геолокационный поиск с умным ранжированием
- Детальную информацию о заведениях с фотографиями и меню
- Прозрачную систему отзывов и рейтингов
- Инструменты продвижения для партнеров
- Удобную модерируемую экосистему

### 1.2 Целевая аудитория

**Пользователи (User):**
- Возраст: 18-45 лет
- География: жители и гости 7 крупных городов Беларуси
- Потребности: быстрый поиск заведения поблизости, просмотр меню и цен, чтение отзывов

**Партнеры (Partner):**
- Владельцы и управляющие ресторанов, кафе, баров
- От небольших семейных кафе до сетевых ресторанов
- Потребности: привлечение клиентов, управление репутацией, аналитика

**Администраторы (Admin):**
- Внутренняя команда управления платформой
- На старте: основатель + возможно 1-2 модератора

### 1.3 Ключевые метрики успеха

**Технические:**
- Время загрузки главного экрана < 2 секунд
- Crash-free rate > 99%
- Размер приложения < 50MB

**Пользовательские:**
- 250-500 заведений к моменту публичного запуска (5-10% от общего числа)
- 1000+ активных пользователей к концу 2-го месяца
- Retention Day 7 > 20%

**Бизнес:**
- 10+ платных подписок к концу 3-го месяца
- Конверсия из триала в платную подписку > 30%

---

## Часть II: Техническая архитектура

### 2.1 Технологический стек

**Frontend (Mobile):**
- Flutter 3.x - кроссплатформенная разработка iOS/Android
- Provider/Riverpod для state management
- Dio для HTTP запросов
- Cached Network Image для оптимизации изображений

**Frontend (Admin Panel):**
- Flutter Web - единый codebase с мобильным приложением
- Responsive design для desktop/tablet
- PWA для возможности установки

**Backend:**
- Node.js + Express (или Django - выбор на этапе проектирования)
- PostgreSQL - основная база данных
- Redis - кэширование и сессии
- JWT - авторизация

**Инфраструктура:**
- Cloudinary - хранение и оптимизация изображений
- SendGrid - email уведомления
- Google Maps API / OpenStreetMap - карты
- Docker - контейнеризация
- GitHub Actions - CI/CD
- Хостинг в регионе (Литва/Польша для низкой латентности)

### 2.2 Архитектура данных

**Основные сущности:**

```
Users {
  id: UUID
  email: string (unique)
  phone: string (unique, optional)
  name: string
  avatar_url: string
  role: enum (user, partner, admin)
  auth_method: enum (email, phone, google, yandex)
  created_at: timestamp
  is_active: boolean
}

Establishments {
  id: UUID
  partner_id: UUID (FK to Users)
  name: string
  description: text
  address: string
  latitude: decimal
  longitude: decimal
  phone: string
  email: string
  category: array[enum]
  cuisine: array[enum]
  price_range: enum ($, $$, $$$)
  working_hours: jsonb
  attributes: jsonb
  status: enum (draft, pending, active, suspended)
  subscription_tier: enum (free, basic, standard, premium)
  subscription_expires_at: timestamp
  boost_score: integer
  created_at: timestamp
}

Reviews {
  id: UUID
  user_id: UUID
  establishment_id: UUID
  rating: integer (1-5)
  text: text
  is_visible: boolean
  created_at: timestamp
}

EstablishmentMedia {
  id: UUID
  establishment_id: UUID
  type: enum (interior, menu)
  url: string
  position: integer
  is_primary: boolean
}

Promotions {
  id: UUID
  establishment_id: UUID
  title: string
  description: text
  valid_from: date
  valid_until: date
  is_active: boolean
}
```

### 2.3 Оптимизация производительности

**Изображения:**
- Три версии каждого изображения: оригинал (1920x1080), превью (800x600), миниатюра (200x150)
- Lazy loading для списков
- Прогрессивная загрузка (сначала миниатюра, затем полное изображение)

**Данные:**
- Пагинация списков (20 элементов на страницу)
- Кэширование часто запрашиваемых данных в Redis
- Предрасчет агрегированных метрик ночными cron-задачами

**Офлайн-функциональность:**
- Кэширование просмотренных заведений
- Сохранение избранного локально с синхронизацией

---

## Часть III: Детальная функциональная спецификация

### 3.1 Пользовательские экраны (User Flow)

#### 3.1.1 Стартовый экран

**Назначение:** Точка входа, где пользователь формирует поисковый запрос.

**Элементы интерфейса:**
- **Кнопка выбора локации** - открывает экран с городами (Минск, Гродно, Брест, Гомель, Витебск, Могилев)
- **Поисковая строка** - для ввода названия конкретного заведения
- **Кнопка "Фильтр"** - открывает экран с детальными параметрами
- **Кнопка "Далее"** - переход к результатам с текущими параметрами

**Нижняя навигация (присутствует на всех экранах):**
- Поиск (текущий экран)
- Новости (отложено после MVP)
- Карта
- Избранное
- Профиль

**Логика работы:**
- При включенной геолокации автоматически определяется город
- Кнопка "Далее" активна всегда, даже без выбора параметров
- При выключенной геолокации заведения показываются в случайном порядке

#### 3.1.2 Экран фильтров

**Структура (скроллируемый экран):**

**Расстояние от вас:**
- В радиусе 500 метров
- В радиусе 1 км
- В радиусе 3 км
- В радиусе 5 км
- В радиусе 10 км
- Весь город (по умолчанию)

*Примечание: При выключенной геолокации секция неактивна*

**Средний чек:**
- $ (бюджетно)
- $$ (средне)
- $$$ (дорого)

**Время работы:**
- До 22:00
- До утра
- 24 часа

**Категория заведения:**
- Кнопка "Все" (активна по умолчанию)
- Ресторан, Кофейня, Фаст-фуд, Бар, Кондитерская, Пиццерия, Пекарня, Паб, Столовая, Кальян, Боулинг, Караоке, Бильярд

**Категория кухни:**
- Кнопка "Все" (активна по умолчанию)
- Народная, Авторская, Азиатская, Американская, Вегетарианская, Японская, Грузинская, Итальянская, Смешанная, Континентальная

**Дополнительные параметры:**
- Доставка еды
- Wi-Fi
- Организация банкетов
- Летняя терраса
- Залы для курящих
- Детская зона
- С домашними животными
- Есть парковка

**UI особенность:** Кнопка "Применить" зафиксирована внизу экрана при скролле

**Логика фильтрации:**
- Множественный выбор в категориях работает по принципу OR (любое совпадение)
- Между разными группами фильтров - AND (все условия должны выполняться)

#### 3.1.3 Экран списка заведений

**Структура экрана:**

**Верхняя панель (статичная):**
- Кнопка выбора локации
- Кнопка "Фильтр"
- Поисковая строка
- Кнопка "Назад"
- Кнопка "Сортировка" (По увеличению чека, По уменьшению чека, По популярности, По новизне, По рейтингу)
- Кнопка "Карта"

**Основная область (скроллируемая):**
- Счетчик результатов ("Найдено 47 заведений")
- Вертикальный список карточек заведений

**Карточка заведения содержит:**
- Главное изображение
- Название
- Рейтинг (звезды + число)
- Средний чек
- Категория заведения и тип кухни
- Время работы + индикатор "Открыто/Закрыто"
- Расстояние от пользователя (при включенной геолокации)
- Адрес
- Кнопка "В избранное"

**Особенности ранжирования:**
- При активной геолокации и сортировке - сначала сортировка внутри ближайшего радиуса, затем следующего
- Платные размещения получают boost к позиции (визуально выделены)

#### 3.1.4 Детальная карточка заведения

**Структура (скроллируемый экран):**

**Галерея изображений (свайп/тап для полноэкранного просмотра):**
- Кнопки поверх изображения: "Назад", "В избранное", "Поделиться"

**Основная информация (на изображении):**
- Название
- Рейтинг и количество отзывов
- Средний чек
- Категория и кухня
- Часы работы с индикатором статуса
- Телефон (кликабельный)
- Email (кликабельный)

**Секция "Меню":**
- Режим работы по дням
- Информация о специальных предложениях (завтраки, бизнес-ланчи)
- Галерея фотографий меню (горизонтальный скролл)

**Атрибуты (иконки с подписями, горизонтальный скролл):**
- Wi-Fi, Парковка, Терраса и другие удобства

**Карта:**
- Адрес (текстом)
- Расстояние от пользователя
- Интерактивная карта с маркером (тап открывает полноэкранную карту)

**Отзывы и рейтинги:**
- Общий рейтинг (большая цифра)
- Количество отзывов
- Карусель отзывов (горизонтальный скролл)
- Кнопка "Написать отзыв" (только для авторизованных)

### 3.2 Личный кабинет пользователя

#### 3.2.1 Экран профиля (неавторизованный)

**Элементы:**
- Кнопка "Войти"
- Кнопка "Зарегистрироваться"
- Секция "Для партнеров" с кнопкой "Разместить объявление"
- Настройки, Политика конфиденциальности, Техподдержка

#### 3.2.2 Регистрация пользователя

**Методы регистрации:**
- По номеру телефона (SMS-верификация)
- По email (письмо с подтверждением)
- OAuth через Google
- OAuth через Yandex

**После регистрации запрашивается:**
- Имя/никнейм
- Фото профиля (опционально)

#### 3.2.3 Профиль авторизованного пользователя

**Информация профиля:**
- Фото и имя (редактируемые)
- Счетчики: количество отзывов, количество оценок

**Секция "Ваши отзывы":**
- Список отзывов с превью заведения
- Возможность удалить отзыв
- Редактирование отзыва возможно в течение 24 часов

#### 3.2.4 Экран избранного

**Структура аналогична экрану списка заведений:**
- Упрощенные фильтры (только основные)
- Сортировка
- Список сохраненных заведений с актуальной информацией

### 3.3 Личный кабинет партнера

#### 3.3.1 Процесс регистрации партнера

**Шаг 1: Выбор категории заведения**
- Можно выбрать до 2 категорий
- Обязательное поле

**Шаг 2: Выбор типа кухни**
- Можно выбрать до 3 типов
- Обязательное поле

**Шаг 3: Основная информация**
- Название (обязательно)
- Описание (обязательно)
- Контактный телефон (обязательно)
- Ссылки на соцсети (опционально)
- Время работы будни/выходные (обязательно)
- Специальные часы (завтраки, обеды) - опционально
- Средний чек (опционально)
- Атрибуты заведения (чекбоксы)

**Шаг 4: Загрузка медиа**
- Фото интерьера/экстерьера: до 20 фото (обязательно минимум 1)
- Фото меню: до 20 фото (обязательно минимум 1)
- Выбор главного фото
- Установка порядка отображения

**Шаг 5: Адрес**
- Населенный пункт (автозаполнение)
- Улица (автозаполнение)
- Дом, корпус

**Шаг 6: Юридическая информация**
- Полное название юрлица (обязательно)
- УНП (с валидацией формата)
- Скан свидетельства о регистрации (обязательно)
- Контактное лицо и email (обязательно)

**Важно:** Система сохраняет прогресс после каждого шага как черновик

#### 3.3.2 Личный кабинет партнера

**Главный экран:**
- Виньетки всех заведений партнера (горизонтальный скролл)
- Каждая виньетка показывает: статус модерации, главное фото, название, метрики

**Виньетка заведения содержит:**
- Статус (на модерации/активно/приостановлено)
- Превью изображения
- Основная информация
- Метрики: просмотры, избранное, отзывы
- Кнопка "Продвижение" (для активных)

**Действия с заведением:**
- Просмотр как видят пользователи
- Редактирование (без повторной модерации для большинства изменений)
- Добавить новое заведение

#### 3.3.3 Аналитика партнера

**Селектор периода:**
- Быстрый выбор: 7 дней, 30 дней, 90 дней
- Произвольный период

**Метрики с визуализацией:**
- Просмотры
- Добавления в избранное
- Отзывы и оценки
- Просмотры акций (для платных тарифов)

**Особенности визуализации:**
- График показывает динамику выбранной метрики
- Подсветка периодов активной платной подписки
- Процентное сравнение с предыдущим периодом
- Автоматическая агрегация: по дням (до 30 дней), по неделям (31-90 дней), по месяцам (>90 дней)

#### 3.3.4 Управление отзывами

**Функциональность:**
- Просмотр всех отзывов с фильтрацией по периоду
- Возможность ответить на отзыв
- Индикация отзывов с ответами и без

### 3.4 Административная панель (Web)

#### 3.4.1 Технические требования

**Платформа:** Flutter Web (PWA)
**Доступ:** Только через защищенный веб-интерфейс
**Безопасность:** Email + пароль + обязательная 2FA

#### 3.4.2 MVP функциональность админ-панели

**Главный дашборд:**
- Карточки с ключевыми метриками: заявки на модерацию, активные пользователи сегодня, новые регистрации, активные заведения
- Список последних действий требующих внимания

**Модерация заявок:**
- Таблица заявок отсортированная по времени (старые первые)
- Детальный просмотр заявки со всеми данными и фото
- Действия: Одобрить / Отклонить (с причиной) / Запросить уточнение
- Автоматическая проверка на дубликаты по адресу

**Управление контентом:**
- Поиск заведения по названию
- Действия: временно скрыть, удалить, просмотреть историю
- Поиск и скрытие проблемных отзывов

**Базовая аналитика:**
- Общее количество заведений/пользователей
- Новые регистрации по дням
- Количество активных подписок

**Журнал действий:**
- Логирование всех административных действий
- Кто, когда, что сделал, с каким объектом

#### 3.4.3 Расширенная функциональность (после MVP)

- Множественные уровни доступа (модератор, старший модератор, супер-админ)
- Детальная аналитика с графиками и экспортом
- Система массовых рассылок
- AI-модерация отзывов
- Управление промо-акциями платформы

---

## Часть IV: Система монетизации

### 4.1 Модель подписок

**Временные периоды:**
- 1 день (для тестирования или разовых событий)
- 3 дня (пакет выходного дня)
- 1 неделя
- 1 месяц

### 4.2 Уровни подписок

**Базовый пакет:**
- Визуальное выделение карточки в списке
- +10% к базовому рейтингу ранжирования

**Стандартный пакет:**
- Все преимущества базового
- Раздел "Акции и спецпредложения" (1 активная акция)
- +25% к базовому рейтингу ранжирования

**Премиум пакет:**
- Все преимущества стандартного
- До 3 активных акций одновременно
- +40% к базовому рейтингу ранжирования
- Приоритет в новостной ленте (после MVP)

### 4.3 Стратегия запуска монетизации

**Месяц 1-2:** Все функции бесплатны для привлечения партнеров
**Месяц 3-4:** Недельный триал для новых, специальные цены для ранних партнеров
**Месяц 5+:** Полноценный запуск с регулярными промо-акциями

### 4.4 Дополнительные ограничения

**Лимиты на фотографии:**
- Бесплатный: 10 интерьер + 10 меню
- Базовый: 15 + 15
- Стандартный: 20 + 20
- Премиум: 30 + 30

---

## Часть V: Протокол итеративной разработки

### 5.1 Методология итеративного анализа UI

При работе с экранами из Figma используется итеративный подход для достижения максимального соответствия дизайну:

**Промпт для активации итеративного режима:**

```
Я хочу, чтобы ты работал итеративно, как дизайнер-программист.
[Прикрепляю изображение экрана]

Алгоритм:
1. Создай первую версию Flutter виджета (60-70% точности)
2. Сравни код с изображением, перечисли отличия
3. Создай улучшенную версию (80-85% точности)
4. Повтори до достижения 90-95% соответствия

Контекст: Приложение для поиска ресторанов в Беларуси
Покажи прогресс каждой итерации.
```

### 5.2 Распределение задач между AI-системами

**Claude (Архитектор):**
- Проектирование архитектуры
- Системный анализ
- Создание переиспользуемых компонентов

**ChatGPT (Итеративный разработчик):**
- Пошаговое улучшение UI
- Доведение до pixel-perfect

**Gemini/Grok (Оптимизаторы):**
- Альтернативные решения
- Оптимизация производительности

### 5.3 Структура проекта в системе контроля версий

```
restaurant_guide_belarus/
├── mobile_app/           # Flutter мобильное приложение
│   ├── lib/
│   │   ├── models/      # Общие модели данных
│   │   ├── screens/     # UI экраны
│   │   ├── widgets/     # Переиспользуемые компоненты
│   │   └── services/    # API и бизнес-логика
├── admin_panel/         # Flutter Web админ-панель
│   └── lib/            # Переиспользует модели из mobile_app
├── backend/            # Node.js/Django API
└── docs/              # Документация и спецификации
```

---

## Часть VI: Дорожная карта разработки

### Фаза 0: Подготовка (Текущая)
- ✅ Создание манифеста со-творчества
- ✅ Функциональная спецификация
- ⏳ Дизайн админ-панели для веб
- ⏳ Настройка окружения разработки

### Фаза 1: Фундамент (Недели 1-2)
- [ ] Финальная схема базы данных
- [ ] API спецификация с админ-endpoints
- [ ] Настройка проекта Flutter с двумя targets (mobile + web)
- [ ] Базовая структура и навигация

### Фаза 2: MVP Frontend (Недели 3-5)
- [ ] Стартовый экран и фильтры
- [ ] Список заведений с mock-данными
- [ ] Детальная карточка заведения
- [ ] Интеграция карт

### Фаза 3: Система пользователей (Недели 6-7)
- [ ] Регистрация и авторизация
- [ ] Профиль пользователя
- [ ] Избранное
- [ ] Отзывы и рейтинги

### Фаза 4: Backend Core (Недели 8-10)
- [ ] Настройка сервера и БД
- [ ] REST API implementation
- [ ] Интеграция с Cloudinary
- [ ] Email уведомления

### Фаза 5: Партнерский функционал (Недели 11-13)
- [ ] Регистрация партнера (многошаговая форма)
- [ ] Личный кабинет партнера
- [ ] Управление заведениями
- [ ] Базовая аналитика

### Фаза 6: Админ-панель MVP (Недели 14-15)
- [ ] Flutter Web setup
- [ ] Дашборд с метриками
- [ ] Модерация заявок
- [ ] Управление контентом

### Фаза 7: Интеграция и тестирование (Неделя 16)
- [ ] Полная интеграция всех компонентов
- [ ] Тестирование основных сценариев
- [ ] Исправление критических багов
- [ ] Подготовка к soft launch

### Фаза 8: Soft Launch (Месяц 5)
- [ ] Запуск с ограниченной группой партнеров
- [ ] Сбор обратной связи
- [ ] Итеративные улучшения

### Фаза 9: Монетизация (Месяц 6)
- [ ] Интеграция платежной системы
- [ ] Реализация платных пакетов
- [ ] Система акций и промо

---

## Часть VII: Принципы принятия решений

### Технические решения
1. **Простота превыше сложности** - Выбираем решение, которое проще поддерживать
2. **Работающее превыше идеального** - Запускаем с базовым функционалом, улучшаем итеративно
3. **Переиспользование превыше создания с нуля** - Используем готовые библиотеки и компоненты
4. **Масштабируемость с первого дня** - Архитектура должна поддерживать рост

### UX/UI решения
1. **Привычные паттерны** - Пользователь должен интуитивно понимать интерфейс
2. **Скорость превыше красоты** - Быстрая загрузка важнее визуальных эффектов
3. **Мобильность превыше универсальности** - Оптимизация под мобильные устройства
4. **Доступность для всех** - Интерфейс должен быть удобен для людей с ограничениями

### Бизнес-решения
1. **Ценность для пользователя превыше монетизации** - Сначала создаем ценность, потом монетизируем
2. **Локальная специфика** - Учитываем особенности белорусского рынка
3. **Обратная связь направляет развитие** - Слушаем пользователей и партнеров
4. **Прозрачность и честность** - Открытые правила для всех участников

---

## Эпилог: Инструкция для AI-партнера

При загрузке этого документа в начале новой сессии разработки, настройся на режим со-творчества:

1. **Помни об итеративном подходе** - Не пытайся создать идеальное решение с первого раза. Начни с работающей основы и улучшай пошагово.

2. **Учитывай контекст** - Это приложение для Беларуси с её спецификой. Решения должны быть практичными и применимыми в местных реалиях.

3. **Фокусируйся на MVP** - Мы строим первую версию для проверки гипотез. Откладывай сложные функции на потом.

4. **Предлагай альтернативы** - Если видишь несколько путей решения, опиши плюсы и минусы каждого.

5. **Сохраняй единство кодовой базы** - Используй общие модели и компоненты между mobile и web версиями.

Этот документ - живой организм, который будет эволюционировать вместе с проектом. Каждая сессия разработки может добавить новое понимание или уточнить детали. Мы не следуем ему слепо, но используем как компас в путешествии создания продукта.

---

*Документ создан в парадигме со-творчества человека и AI*
*Следующее обновление: После завершения Фазы 1*